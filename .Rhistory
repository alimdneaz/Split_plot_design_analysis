cat("Dimension of the dataframe",dim(df))
cat("Str: ", str(df))
df$Rep <- as.factor(df$Rep)
df$Tillage <- as.factor(df$Tillage)
df$Organic_Manure <- as.factor(df$Organic_Manure)
table(df$Rep)
table(df$Tillage)
model <- lmer(df$Yield ~ df$Organic_Manure+df$Tillage + (1|df$Rep))
summary(model)
anova(model)
model <- lmer(df$Yield ~ df$Organic_Manure*df$Tillage + (1|df$Rep))
summary(model)
model <- lmer(df$Yield ~ df$Tillage + df$Organic_Manure + df$Rep +  df$Organic_Manure*df$Tillage + (1|df$Rep))
summary(model)
model <- lmer(df$Yield ~ df$Tillage + df$Organic_Manure+  df$Organic_Manure*df$Tillage + (1|df$Rep)) # Rep is random
summary(model)
anova(model)
emm_tillage <- emmeans(model, ~ Tillage)
emm_manure <- emmeans(model, ~ Organic_Manure)
emm_interaction <- emmeans(model, ~ Tillage * Organic_Manure)
print((summary(emm_tillage)))
print(summary(emm_tillage))
print(summary(emm_manure))
print(summary(emm_interaction))
pairs(emm_tillage)
pairs(emm_manure)
pairs(emm_interaction)
ggplot(df, aes(x = Tillage, y = Yield, fill = Organic_Manure)) +
geom_boxplot() +
labs(title = "Interaction between Tillage and Organic Manure on Yield") +
theme_minimal()
plot(model, which = 1)
plot(model, which = 2)
plot(model, which = 2)
plot(model, which = 3)
# Plot: Residuals vs Leverage
plot(model, which = 5)
model <- lmer(Yield ~ Tillage + Organic_Manure + Tillage * Organic_Manure + (1 | Rep), data = df)# Rep is random
summary(model)
anova(model)
emm_tillage <- emmeans(model, ~ Tillage)
emm_manure <- emmeans(model, ~ Organic_Manure)
emm_interaction <- emmeans(model, ~ Tillage * Organic_Manure)
print(summary(emm_tillage))
print(summary(emm_manure))
print(summary(emm_interaction))
pairs(emm_tillage)
pairs(emm_manure)
pairs(emm_interaction)
ggplot(df, aes(x = Tillage, y = Yield, fill = Organic_Manure)) +
geom_boxplot() +
labs(title = "Interaction between Tillage and Organic Manure on Yield") +
theme_minimal()
plot(model, which = 1)
plot(model, which = 2)
plot(model, which = 3)
# Plot: Residuals vs Leverage
plot(model, which = 5)
residuals_model  <- residuals(model)
summary(residuals_model)
# Residuals vs Fitted plot
fitted_values <- fitted(model)
residuals_model <- residuals(model)
plot(fitted_values, residuals_model, main = "Residuals vs Fitted", xlab = "Fitted Values", ylab = "Residuals")
abline(h = 0, col = "red")  # Add a horizontal line at zero
# Check for Cook's distance
cooks_d <- cooks.distance(model)
plot(cooks_d, main = "Cook's Distance", ylab = "Cook's Distance")
abline(h = 4 / length(cooks_d), col = "red")  # Threshold for influential points
library(car)
vif(model)
# Extract residuals and fitted values
fitted_values <- fitted(model)
residuals_values <- residuals(model)
# Create the ggplot
ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
ggplot(data.frame(Residuals = residuals_values), aes(sample = Residuals)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(title = "Normal Q-Q Plot") +
theme_minimal()
dim(df)
# Calculate the standardized residuals and the fitted values
std_residuals <- rstandard(model)
# Calculate the standardized residuals and the fitted values
std_residuals <- rstandard(model)
# Calculate Cook's Distance
cooks_distance <- cooks.distance(model)
# Create a Cook's distance plot
ggplot(data.frame(Index = seq_along(cooks_distance), CooksDistance = cooks_distance), aes(x = Index, y = CooksDistance)) +
geom_bar(stat = "identity", fill = "steelblue", alpha = 0.7) +
geom_hline(yintercept = 4 / length(cooks_distance), color = "red", linetype = "dashed") +
labs(title = "Cook's Distance", x = "Index", y = "Cook's Distance") +
theme_minimal()
# Plot the autocorrelation of residuals
acf(residuals(model), main = "Autocorrelation of Residuals", col = "blue", lwd = 2)
# Create a fitted vs observed plot
ggplot(data.frame(Observed = df$Yield, Fitted = fitted_values), aes(x = Observed, y = Fitted)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Fitted vs Observed", x = "Observed Values", y = "Fitted Values") +
theme_minimal()
# Create individual plots
p1 <- ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
p2 <- ggplot(data.frame(Residuals = residuals_values), aes(sample = Residuals)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(title = "Normal Q-Q Plot") +
theme_minimal()
p3 <- ggplot(data.frame(Fitted = fitted_values, StdResiduals = std_residuals), aes(x = Fitted, y = StdResiduals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Scale-Location", x = "Fitted Values", y = "Standardized Residuals") +
theme_minimal()
# Create individual plots
p1 <- ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
p2 <- ggplot(data.frame(Fitted = fitted_values, StdResiduals = std_residuals), aes(x = Fitted, y = StdResiduals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Scale-Location (Standardized Residuals vs Fitted)", x = "Fitted Values", y = "Standardized Residuals") +
theme_minimal()
# Create individual plots
p1 <- ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
p2 <- ggplot(data.frame(StdResiduals = std_residuals), aes(sample = StdResiduals)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(title = "Normal Q-Q Plot (Standardized Residuals)") +
theme_minimal()
std_residuals <- residuals_model/residual_sd
fitted_values <- fitted(model)
residual_sd <- sd(residuals_model)
std_residuals <- residuals_model/residual_sd
fitted_values <- fitted(model)
residual_sd <- sd(residuals_model)
std_residuals <- residuals_model/residual_sd
# Create individual plots
p1 <- ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
p2 <- ggplot(data.frame(StdResiduals = std_residuals), aes(sample = StdResiduals)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(title = "Normal Q-Q Plot (Standardized Residuals)") +
theme_minimal()
p3 <- ggplot(data.frame(Fitted = fitted_values, StdResiduals = std_residuals), aes(x = Fitted, y = StdResiduals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Scale-Location", x = "Fitted Values", y = "Standardized Residuals") +
theme_minimal()
p4 <- ggplot(data.frame(Index = seq_along(cooks_distance), CooksDistance = cooks_distance), aes(x = Index, y = CooksDistance)) +
geom_bar(stat = "identity", fill = "steelblue", alpha = 0.7) +
geom_hline(yintercept = 4 / length(cooks_distance), color = "red", linetype = "dashed") +
labs(title = "Cook's Distance", x = "Index", y = "Cook's Distance") +
theme_minimal()
# Combine all plots into a grid
grid.arrange(p1, p2, p3, p4, ncol = 2)
library(gridExtra)
library(gridExtra)
fitted_values <- fitted(model)
residual_sd <- sd(residuals_model)
std_residuals <- residuals_model/residual_sd
# Create individual plots
p1 <- ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
p2 <- ggplot(data.frame(StdResiduals = std_residuals), aes(sample = StdResiduals)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(title = "Normal Q-Q Plot (Standardized Residuals)") +
theme_minimal()
p3 <- ggplot(data.frame(Fitted = fitted_values, StdResiduals = std_residuals), aes(x = Fitted, y = StdResiduals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Scale-Location", x = "Fitted Values", y = "Standardized Residuals") +
theme_minimal()
p4 <- ggplot(data.frame(Index = seq_along(cooks_distance), CooksDistance = cooks_distance), aes(x = Index, y = CooksDistance)) +
geom_bar(stat = "identity", fill = "steelblue", alpha = 0.7) +
geom_hline(yintercept = 4 / length(cooks_distance), color = "red", linetype = "dashed") +
labs(title = "Cook's Distance", x = "Index", y = "Cook's Distance") +
theme_minimal()
# Combine all plots into a grid
grid.arrange(p1, p2, p3, p4, ncol = 2)
library(gridExtra)
fitted_values <- fitted(model)
residual_sd <- sd(residuals_model)
std_residuals <- residuals_model/residual_sd
# Create individual plots
p1 <- ggplot(data.frame(Fitted = fitted_values, Residuals = residuals_values), aes(x = Fitted, y = Residuals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
theme_minimal()
p2 <- ggplot(data.frame(Fitted = fitted_values, StdResiduals = std_residuals), aes(x = Fitted, y = StdResiduals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Scale-Location (Standardized Residuals vs Fitted)", x = "Fitted Values", y = "Standardized Residuals") +
theme_minimal()
p3 <- ggplot(data.frame(Fitted = fitted_values, StdResiduals = std_residuals), aes(x = Fitted, y = StdResiduals)) +
geom_point(color = "blue", alpha = 0.7) +
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") +
labs(title = "Scale-Location", x = "Fitted Values", y = "Standardized Residuals") +
theme_minimal()
p4 <- ggplot(data.frame(Index = seq_along(cooks_distance), CooksDistance = cooks_distance), aes(x = Index, y = CooksDistance)) +
geom_bar(stat = "identity", fill = "steelblue", alpha = 0.7) +
geom_hline(yintercept = 4 / length(cooks_distance), color = "red", linetype = "dashed") +
labs(title = "Cook's Distance", x = "Index", y = "Cook's Distance") +
theme_minimal()
# Combine all plots into a grid
grid.arrange(p1, p2, p3, p4, ncol = 2)
rstandard(model)
ggplot(df, aes(x = Tillage, y = Yield, fill = Tillage)) +
geom_boxplot(outlier.colour = "red", outlier.shape = 16, outlier.size = 3) +  # Add boxplot with styled outliers
stat_summary(fun = mean, geom = "point", shape = 4, size = 4, color = "black", stroke = 1.5) +  # Add mean as points
scale_fill_manual(values = c("skyblue", "lightgreen")) +  # Customize fill colors
labs(
title = "Effect of Tillage on Crop Yield",
subtitle = "Comparing Conventional vs. Conservation Tillage",
x = "Tillage Type",
y = "Yield (Units)",
fill = "Tillage"
) +
theme_minimal(base_size = 14) +  # Use minimal theme with larger base font size
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5),  # Center and bold the title
plot.subtitle = element_text(size = 12, hjust = 0.5),  # Center the subtitle
axis.text = element_text(color = "black"),  # Black axis labels
legend.position = "top",  # Place legend at the top
legend.title = element_text(face = "bold")  # Bold legend title
) +
coord_flip()  # Flip coordinates for horizontal boxplots (optional)
ggplot(df, aes(x = Tillage, y = Yield, fill = Manure)) +
geom_boxplot() +
labs(title = "Boxplot of Yield by Tillage and Manure", x = "Tillage", y = "Yield") +
scale_fill_manual(values = c("lightblue", "lightgreen", "lightpink")) +
theme_minimal() +
theme(legend.title = element_text(size = 12), legend.position = "top")
ggplot(df, aes(x = Tillage, y = Yield, fill = Organic_Manure)) +
geom_boxplot() +
labs(title = "Boxplot of Yield by Tillage and Manure", x = "Tillage", y = "Yield") +
scale_fill_manual(values = c("lightblue", "lightgreen", "lightpink")) +
theme_minimal() +
theme(legend.title = element_text(size = 12), legend.position = "top")
ggplot(df, aes(x = Tillage, y = Yield, fill = Manure)) +
geom_boxplot() +
facet_wrap(~ Rep, scales = "free_y") +  # Separate boxplots for each Replication
labs(title = "Boxplot of Yield by Tillage, Manure, and Replication", x = "Tillage", y = "Yield") +
scale_fill_manual(values = c("lightblue", "lightgreen", "lightpink")) +
theme_minimal() +
theme(legend.position = "top")
ggplot(df, aes(x = Tillage, y = Yield, fill = Organic_Manure)) +
geom_boxplot() +
facet_wrap(~ Rep, scales = "free_y") +  # Separate boxplots for each Replication
labs(title = "Boxplot of Yield by Tillage, Manure, and Replication", x = "Tillage", y = "Yield") +
scale_fill_manual(values = c("lightblue", "lightgreen", "lightpink")) +
theme_minimal() +
theme(legend.position = "top")
# Check the unique levels of Organic_Manure
unique_manure_levels <- levels(df$Organic_Manure)
# Define the number of colors needed based on the levels
n_levels <- length(unique_manure_levels)
color_palette <- c("lightblue", "lightgreen", "lightpink", "lightyellow")  # Adjust colors if needed
# Generate the plot with adjusted color palette
ggplot(df, aes(x = Tillage, y = Yield, fill = Organic_Manure)) +
geom_boxplot() +
facet_wrap(~ Rep, scales = "free_y") +  # Separate boxplots for each Replication
labs(title = "Boxplot of Yield by Tillage, Manure, and Replication", x = "Tillage", y = "Yield") +
scale_fill_manual(values = color_palette[1:n_levels]) +  # Use the correct number of colors
theme_minimal() +
theme(legend.position = "top")
boxplot(Yield ~ Tillage)
boxplot(Yield ~ Tillage, data = df)
ggplot(df, aes(x = Tillage, y = Yield, fill = Tillage)) +
geom_boxplot(outlier.shape = 16, outlier.size = 2, outlier.colour = "red") +  # Customize outliers
scale_fill_brewer(palette = "Set3") +  # Use a color palette for the box fill
labs(title = "Boxplot of Yield by Tillage",
x = "Tillage",
y = "Yield") +
theme_minimal() +  # Clean minimal theme
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center and bold title
axis.title = element_text(size = 14),  # Axis title size
axis.text = element_text(size = 12),  # Axis text size
legend.position = "none"  # Remove legend
)
boxplot(Yield ~ Organic_Manure, data = df)
# Aesthetic Boxplot of Yield by Organic_Manure
ggplot(df, aes(x = Organic_Manure, y = Yield, fill = Organic_Manure)) +
geom_boxplot(outlier.shape = 16, outlier.size = 2, outlier.colour = "red") +  # Customize outliers
scale_fill_brewer(palette = "Pastel1") +  # Use a light, pastel color palette
labs(title = "Boxplot of Yield by Organic Manure",
x = "Organic Manure",
y = "Yield") +
theme_minimal() +  # Clean minimal theme
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center and bold title
axis.title = element_text(size = 14),  # Axis title size
axis.text = element_text(size = 12),  # Axis text size
legend.position = "none"  # Remove legend
)
boxplot(Yield ~ Tillage + Organic_Manure, data = df)
# Aesthetic Boxplot of Yield by Tillage and Organic Manure
ggplot(df, aes(x = interaction(Tillage, Organic_Manure), y = Yield, fill = interaction(Tillage, Organic_Manure))) +
geom_boxplot(outlier.shape = 16, outlier.size = 2, outlier.colour = "red") +  # Customize outliers
scale_fill_brewer(palette = "Set3") +  # Use a color palette for the interaction levels
labs(title = "Boxplot of Yield by Tillage and Organic Manure",
x = "Tillage and Organic Manure",
y = "Yield") +
theme_minimal() +  # Clean minimal theme
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center and bold title
axis.title = element_text(size = 14),  # Axis title size
axis.text = element_text(size = 12),  # Axis text size
legend.position = "none"  # Remove legend
)
boxplot(Yield ~ Rep, data = df)
# Aesthetic Boxplot of Yield by Replication (Rep)
ggplot(df, aes(x = Rep, y = Yield, fill = Rep)) +
geom_boxplot(outlier.shape = 16, outlier.size = 2, outlier.colour = "red") +  # Customize outliers
scale_fill_brewer(palette = "Set1") +  # Use a color palette for Replication groups
labs(title = "Boxplot of Yield by Replication",
x = "Replication",
y = "Yield") +
theme_minimal() +  # Clean minimal theme
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center and bold title
axis.title = element_text(size = 14),  # Axis title size
axis.text = element_text(size = 12),  # Axis text size
legend.position = "none"  # Remove legend
)
boxplot(Yield ~ Rep + Tillage, data = df)
# Aesthetic Boxplot of Yield by Rep and Tillage
ggplot(df, aes(x = interaction(Rep, Tillage), y = Yield, fill = interaction(Rep, Tillage))) +
geom_boxplot(outlier.shape = 16, outlier.size = 2, outlier.colour = "red") +  # Customize outliers
scale_fill_brewer(palette = "Set3") +  # Use a color palette for the interaction levels
labs(title = "Boxplot of Yield by Replication and Tillage",
x = "Replication and Tillage",
y = "Yield") +
theme_minimal() +  # Clean minimal theme
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center and bold title
axis.title = element_text(size = 14),  # Axis title size
axis.text = element_text(size = 12),  # Axis text size
legend.position = "none"  # Remove legend
)
boxplot(Yield ~ Rep + Organic_Manure, data = df)
# Aesthetic Boxplot of Yield by Rep and Organic Manure
ggplot(df, aes(x = interaction(Rep, Organic_Manure), y = Yield, fill = interaction(Rep, Organic_Manure))) +
geom_boxplot(outlier.shape = 16, outlier.size = 2, outlier.colour = "red") +  # Customize outliers
scale_fill_brewer(palette = "Set3") +  # Use a color palette for the interaction levels
labs(title = "Boxplot of Yield by Replication and Organic Manure",
x = "Replication and Organic Manure",
y = "Yield") +
theme_minimal() +  # Clean minimal theme
theme(
plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center and bold title
axis.title = element_text(size = 14),  # Axis title size
axis.text = element_text(size = 12),  # Axis text size
legend.position = "none"  # Remove legend
)
ggplot(df, aes(x = Yield)) +
geom_histogram(aes(y = ..density..),
bins = 30,
fill = "lightblue",
color = "black",
alpha = 0.7) +  # Adjust histogram transparency
geom_density(color = "red", size = 1.2) +  # Overlay density curve
labs(title = "Histogram with Density Curve for Yield",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))  # Title customization
ggplot(df, aes(x = Yield)) +
geom_histogram(aes(y = ..density..),
bins = 30,
fill = "green",
color = "black",
alpha = 0.7) +  # Adjust histogram transparency
geom_density(color = "yellow", size = 1.2) +  # Overlay density curve
labs(title = "Histogram with Density Curve for Yield",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))  # Title customization
ggplot(df, aes(x = Yield)) +
geom_histogram(aes(y = ..density..),
bins = 30,
fill = "green",
color = "black",
alpha = 0.7) +  # Adjust histogram transparency
geom_density(color = "black", size = 1.2) +  # Overlay density curve
labs(title = "Histogram with Density Curve for Yield",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))  # Title customization
ggplot(df, aes(x = Yield, fill = Tillage)) +
geom_histogram(aes(y = ..density..),
bins = 30,
color = "black",
alpha = 0.6) +
geom_density(aes(color = Tillage), size = 1.2) +  # Separate density curves by Tillage
labs(title = "Histogram with Density Curve by Tillage",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
ggplot(df, aes(x = Yield, fill = Organic_Manure)) +
geom_histogram(aes(y = ..density..),
bins = 30,
color = "black",
alpha = 0.6) +
geom_density(aes(color = Organic_Manure), size = 1.2) +  # Separate density curves by Organic Manure
labs(title = "Histogram with Density Curve by Organic Manure",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
ggplot(df, aes(x = Yield, fill = Rep)) +
geom_histogram(aes(y = ..density..),
bins = 30,
color = "black",
alpha = 0.6) +
geom_density(aes(color = Rep), size = 1.2) +  # Separate density curves by Replication
labs(title = "Histogram with Density Curve by Replication",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
ggplot(df, aes(x = Yield, fill = Tillage)) +
geom_histogram(aes(y = ..density..),
bins = 30,
color = "black",
alpha = 0.6) +
geom_density(aes(color = Tillage), size = 1.2) +  # Separate density curves by Tillage
facet_wrap(~ Organic_Manure) +  # Facet by Organic Manure
labs(title = "Histogram with Density Curve by Tillage and Organic Manure",
x = "Yield",
y = "Density") +
theme_minimal() +
theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
ggplot(df, aes(x = Tillage, y = Yield, fill = Organic_Manure)) +
geom_boxplot() +
labs(title = "Boxplot of Yield by Tillage and Manure", x = "Tillage", y = "Yield") +
scale_fill_manual(values = c("lightblue", "lightgreen", "lightpink")) +
theme_minimal() +
theme(legend.title = element_text(size = 12), legend.position = "top")
# Calculate the standardized residuals and the fitted values
std_residuals <- rstandard(model)
library(agricolae)
df <- read.csv("./split_plot.csv", header = T)
df$Rep <- as.factor(df$Rep)
df$Tillage <- as.factor(df$Tillage)
df$Organic_Manure <- as.factor(df$Organic_Manure)
split_plot <- with(df,design.split(
trt1 = Tillage,
trt2 = Organic_Manure,
r = Rep,
response = Yield
))
split_plot <- with(df,design.split(
trt1 = Tillage,
trt2 = Organic_Manure,
r = Rep,
response  = Yield
))
split_plot <- with(df,design.split(
trt1 = Tillage,
trt2 = Organic_Manure,
r = Rep,
response  = Yield
))
split_plot <- with(df,design.split(
trt1 = df$Tillage,
trt2 = df$Tillage,
r = df$Rep,
response  = df$Yield
))
split_plot <- with(df,design.split(
trt1 = df$Tillage,
trt2 = df$Tillage,
r = df$Rep
))
split_plot$ANOVA
library(lmerTest)
# Fit the model
model <- lmer(Yield ~ Tillage * Manure + (1 | Rep) + (1 | Rep:Tillage), data = df)
# Fit the model
model <- lmer(Yield ~ Tillage * Organic_Manure + (1 | Rep) + (1 | Rep:Tillage), data = df)
model <- lmer(Yield ~ Tillage * Organic_Manure + (1 | Rep) + (1 | Rep:Tillage), data = df)
model <- lm(df$Yield ~ df$Tillage + Error(df$Tillage)+ df$Organic_Manure + df$Tillage:df$Organic_Manure)
model <- aov(Yield ~ Tillage * Organic_Manure + Error(Rep/Tillage), data = df)
summary(model)
